<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Power to reject a hypothesis for one proportion in group testing — gtPower • binGroup2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power to reject a hypothesis for one proportion in group testing — gtPower"><meta name="description" content="This function calculates the power to reject a hypothesis
in a group testing experiment, using confidence intervals for the
decision. This function also calculates the bias of the point estimator
for a given \(n\), \(s\), and true, unknown proportion."><meta property="og:description" content="This function calculates the power to reject a hypothesis
in a group testing experiment, using confidence intervals for the
decision. This function also calculates the bias of the point estimator
for a given \(n\), \(s\), and true, unknown proportion."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">binGroup2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Identification-through-group-testing.html">Identification-through-group-testing</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bdhitt/binGroup2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Power to reject a hypothesis for one proportion in group testing</h1>
      <small class="dont-index">Source: <a href="https://github.com/bdhitt/binGroup2/blob/main/R/gtPower.R" class="external-link"><code>R/gtPower.R</code></a></small>
      <div class="d-none name"><code>gtPower.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates the power to reject a hypothesis
in a group testing experiment, using confidence intervals for the
decision. This function also calculates the bias of the point estimator
for a given \(n\), \(s\), and true, unknown proportion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gtPower</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">s</span>,</span>
<span>  <span class="va">delta</span>,</span>
<span>  <span class="va">p.hyp</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"CP"</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>integer specifying the number of groups. A vector of integers is
also allowed.</p></dd>


<dt id="arg-s">s<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>integer specifying the common group size. A vector of integers is
also allowed.</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>the absolute difference between the true proportion and the
hypothesized proportion. A vector is also allowed.</p></dd>


<dt id="arg-p-hyp">p.hyp<a class="anchor" aria-label="anchor" href="#arg-p-hyp"></a></dt>
<dd><p>the proportion in the hypotheses, specified as a value between
0 and 1.</p></dd>


<dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>confidence level required for the decision on the
hypotheses.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string specifying the confidence interval method
(see <code><a href="propCI.html">propCI</a></code>) to be used.</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>character string defining the alternative hypothesis,
either <kbd>"two.sided"</kbd>, <kbd>"less"</kbd>, or <kbd>"greater"</kbd>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix containing the following columns:</p>
<dl><dt>ns</dt>
<dd><p>a vector of the total sample size, \(n*s\).</p></dd>

<dt>n</dt>
<dd><p>a vector of the number of groups.</p></dd>

<dt>s</dt>
<dd><p>a vector of the group sizes.</p></dd>

<dt>delta</dt>
<dd><p>a vector of the delta values.</p></dd>

<dt>power</dt>
<dd><p>the power to reject the given null hypothesis.</p></dd>

<dt>bias</dt>
<dd><p>the bias of the estimator for the specified
\(n\), \(s\), and the true proportion.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The power of a hypothesis test performed by a confidence
interval is defined as the probability that a confidence interval
excludes the threshold parameter (<kbd>p.hyp</kbd>) of the null hypothesis,
as described in Schaarschmidt (2007). Due to discreteness, the power
does not increase monotonically for an increasing number of groups \(n\)
or group size \(s\), but exhibits local maxima and minima, depending
on \(n\), \(s\), <kbd>p.hyp</kbd>, and <kbd>conf.level</kbd>.</p>
<p>Additional to the power, the bias of the point estimator is calculated
according to Swallow (1985). If vectors are specified for \(n\),
\(s\), and (or) delta, a matrix will be constructed and power and
bias are calculated for each line in this matrix.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Schaarschmidt, F. (2007).
“Experimental design for one-sided confidence intervals or hypothesis tests in binomial group testing.”
<em>Communications in Biometry and Crop Science</em>, <b>2</b>, 32–40.
ISSN 1896-0782.</p>
<p>Swallow, W. (1985).
“Group testing for estimating infection rates and probabilities of disease transmission.”
<em>Phytopathology</em>, <b>75</b>, 882–889.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="propCI.html">propCI</a></code> for confidence intervals and
<code><a href="gtTest.html">gtTest</a></code> for hypothesis tests for one proportion from a
group testing experiment.</p>
<p>Other estimation functions:
<code><a href="designEst.html">designEst</a>()</code>,
<code><a href="designPower.html">designPower</a>()</code>,
<code><a href="gtTest.html">gtTest</a>()</code>,
<code><a href="gtWidth.html">gtWidth</a>()</code>,
<code><a href="propCI.html">propCI</a>()</code>,
<code><a href="propDiffCI.html">propDiffCI</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>This function was originally written as <code>bgtPower</code> by Frank
Schaarschmidt for the <code>binGroup</code> package. Minor modifications have
been made for inclusion of the function in the <code>binGroup2</code> package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Calculate the power for the design</span></span></span>
<span class="r-in"><span><span class="co">#   in the example given in Tebbs and Bilder(2004):</span></span></span>
<span class="r-in"><span><span class="co">#   n=24 groups each containing 7 insects</span></span></span>
<span class="r-in"><span><span class="co">#   if the true proportion of virus vectors</span></span></span>
<span class="r-in"><span><span class="co">#   in the population is 0.04 (4 percent),</span></span></span>
<span class="r-in"><span><span class="co">#   the power to reject H0: p&gt;=0.1 using an</span></span></span>
<span class="r-in"><span><span class="co">#   upper Clopper-Pearson ("CP") confidence interval</span></span></span>
<span class="r-in"><span><span class="co">#   is calculated with the following call:</span></span></span>
<span class="r-in"><span><span class="fu">gtPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">24</span>, s <span class="op">=</span> <span class="fl">7</span>, delta <span class="op">=</span> <span class="fl">0.06</span>, p.hyp <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        conf.level <span class="op">=</span> <span class="fl">0.95</span>, alternative <span class="op">=</span> <span class="st">"less"</span>,</span></span>
<span class="r-in"><span>        method <span class="op">=</span> <span class="st">"CP"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ns  n s delta     power         bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n 168 24 7  0.06 0.8821248 0.0008405368</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Explore development of power and bias for varying n,</span></span></span>
<span class="r-in"><span><span class="co">#   s, and delta. How much can we decrease the number of</span></span></span>
<span class="r-in"><span><span class="co">#   groups (costly tests to be performed) by pooling the</span></span></span>
<span class="r-in"><span><span class="co">#   same number of 320 individuals to groups of</span></span></span>
<span class="r-in"><span><span class="co">#   increasing size without largely decreasing power?</span></span></span>
<span class="r-in"><span><span class="fu">gtPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">320</span>, <span class="fl">160</span>, <span class="fl">80</span>, <span class="fl">64</span>, <span class="fl">40</span>, <span class="fl">32</span>, <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">16</span>, <span class="fl">32</span>, <span class="fl">64</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        delta <span class="op">=</span> <span class="fl">0.01</span>,  p.hyp <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ns   n  s delta       power         bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 320 320  1  0.01 0.169575200 3.122502e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 320 160  2  0.01 0.153984506 4.775749e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 320  80  4  0.01 0.171809348 1.485202e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 320  64  5  0.01 0.172465973 2.017053e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 320  40  8  0.01 0.138488643 3.737105e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 320  32 10  0.01 0.175933578 4.999685e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 320  20 16  0.01 0.102452816 9.486069e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 320  10 32  0.01 0.062895913 1.090916e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 320   5 64  0.01 0.001819794 4.455608e-01</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># What happens to the power for increasing differences</span></span></span>
<span class="r-in"><span><span class="co">#   between the true proportion and the threshold</span></span></span>
<span class="r-in"><span><span class="co">#   proportion?</span></span></span>
<span class="r-in"><span><span class="fu">gtPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, s <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>        delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">0.01</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        p.hyp <span class="op">=</span> <span class="fl">0.01</span>, method <span class="op">=</span> <span class="st">"CP"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ns  n  s delta      power         bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 500 50 10 0.000 0.02509474 9.556995e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 500 50 10 0.001 0.02045901 1.056338e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 500 50 10 0.002 0.02240288 1.157943e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 500 50 10 0.003 0.03154284 1.260525e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 500 50 10 0.004 0.04988657 1.364095e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 500 50 10 0.005 0.08170390 1.468667e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 500 50 10 0.006 0.13481479 1.574252e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 500 50 10 0.007 0.22262947 1.680863e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 500 50 10 0.008 0.31313453 1.788510e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 500 50 10 0.009 0.37280062 1.897208e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 500 50 10 0.010 0.43351536 2.006969e-04</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate power with a group size of 1 (individual</span></span></span>
<span class="r-in"><span><span class="co">#   testing).</span></span></span>
<span class="r-in"><span><span class="fu">gtPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, s <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">0.01</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        p.hyp <span class="op">=</span> <span class="fl">0.01</span>, method <span class="op">=</span> <span class="st">"CP"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ns   n s delta        power         bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 100 100 1 0.000 1.837404e-02 1.734723e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 100 100 1 0.001 1.299201e-02 1.908196e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 100 100 1 0.002 8.743140e-03 2.081668e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 100 100 1 0.003 5.525839e-03 2.081668e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 100 100 1 0.004 3.216655e-03 2.602085e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 100 100 1 0.005 1.673268e-03 2.775558e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 100 100 1 0.006 7.394374e-04 2.775558e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 100 100 1 0.007 2.524704e-04 2.775558e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 100 100 1 0.008 5.382635e-05 3.122502e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 100 100 1 0.009 3.631682e-06 3.122502e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 100 100 1 0.010 0.000000e+00 3.469447e-17</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brianna Hitt, Christopher Bilder, Frank Schaarschmidt, Brad Biggerstaff, Christopher McMahan, Joshua Tebbs.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

