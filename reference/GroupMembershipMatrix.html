<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Construct a group membership matrix for hierarchical algorithms — GroupMembershipMatrix • binGroup2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Construct a group membership matrix for hierarchical algorithms — GroupMembershipMatrix"><meta name="description" content="Construct a group membership matrix for two-, three-, or
four-stage hierarchical algorithms."><meta property="og:description" content="Construct a group membership matrix for two-, three-, or
four-stage hierarchical algorithms."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">binGroup2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Identification-through-group-testing.html">Identification-through-group-testing</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bdhitt/binGroup2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Construct a group membership matrix for hierarchical algorithms</h1>
      <small class="dont-index">Source: <a href="https://github.com/bdhitt/binGroup2/blob/main/R/SupportingOpCharFunctions.R" class="external-link"><code>R/SupportingOpCharFunctions.R</code></a></small>
      <div class="d-none name"><code>GroupMembershipMatrix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Construct a group membership matrix for two-, three-, or
four-stage hierarchical algorithms.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">GroupMembershipMatrix</span><span class="op">(</span><span class="va">stage1</span>, stage2 <span class="op">=</span> <span class="cn">NULL</span>, stage3 <span class="op">=</span> <span class="cn">NULL</span>, stage4 <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-stage-">stage1<a class="anchor" aria-label="anchor" href="#arg-stage-"></a></dt>
<dd><p>the group size in stage one of testing. This also corresponds
to the number of individuals to be tested and will specify the number of
columns in the resulting group membership matrix.</p></dd>


<dt id="arg-stage-">stage2<a class="anchor" aria-label="anchor" href="#arg-stage-"></a></dt>
<dd><p>a vector of group sizes in stage two of testing. The group sizes
specified here should sum to the number of individuals/group size specified
in <kbd>stage1</kbd>. If <kbd>NULL</kbd>, a group membership matrix will be constructed
for a two-stage hierarchical algorithm.
Further details are given under 'Details'.</p></dd>


<dt id="arg-stage-">stage3<a class="anchor" aria-label="anchor" href="#arg-stage-"></a></dt>
<dd><p>a vector of group sizes in stage three of testing. The group sizes
specified here should sum to the number of individuals/group size specified
in <kbd>stage1</kbd>. If group sizes are provided in <kbd>stage2</kbd> and <kbd>stage3</kbd>
is <kbd>NULL</kbd>, a group membership matrix will be constructed for a
three-stage hierarchical algorithm. Further details are given under 'Details'.</p></dd>


<dt id="arg-stage-">stage4<a class="anchor" aria-label="anchor" href="#arg-stage-"></a></dt>
<dd><p>a vector of group sizes in stage four of testing. The group sizes
specified here should sum to the number of individuals/group size specified
in <kbd>stage1</kbd>. If group sizes are provided in <kbd>stage3</kbd> and <kbd>stage4</kbd>
is <kbd>NULL</kbd>, a group membership matrix will be constructed for a four-stage
hierarchical algorithm. Further details are given under 'Details'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix specifying the group membership for each individual. The
rows of the matrix correspond to the stages of testing and the columns of
the matrix correspond to the individuals to be tested.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function constructs a group membership matrix for two-, three-,
four-, or five-stage hierarchical algorithms. The resulting group membership
matrix has rows corresponding to the number of stages of testing and columns
corresponding to each individual to be tested. The value specified in
<kbd>stage1</kbd> corresponds to the number of individuals to be tested.</p>
<p>For group membership matrices when only <kbd>stage1</kbd> is specified, a two-stage
hierarchical algorithm is used and the second stage will consist of individual
testing. For group membership matrices when <kbd>stage1</kbd> and <kbd>stage2</kbd> are
specified, a three-stage hierarchical algorithm is used and the third stage
will consist of individual testing. Group membership matrices for four- and
five-stage hierarchical algorithms follow a similar structure.
There should never be group sizes specified for later
stages of testing without also providing group sizes for all earlier stages
of testing (i.e., to provide group sizes for <kbd>stage3</kbd>, group sizes must
also be provided for <kbd>stage1</kbd> and <kbd>stage2</kbd>).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other operating characteristic functions:
<code><a href="Sterrett.html">Sterrett</a>()</code>,
<code><a href="TOD.html">TOD</a>()</code>,
<code><a href="halving.html">halving</a>()</code>,
<code><a href="operatingCharacteristics1.html">operatingCharacteristics1</a>()</code>,
<code><a href="operatingCharacteristics2.html">operatingCharacteristics2</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Minh Nguyen and Christopher Bilder</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate a group membership matrix for a two-stage</span></span></span>
<span class="r-in"><span><span class="co">#   hierarchical algorithm, within the opChar1() function</span></span></span>
<span class="r-in"><span><span class="co">#   and calculate operating characteristics</span></span></span>
<span class="r-in"><span><span class="fu"><a href="operatingCharacteristics1.html">opChar1</a></span><span class="op">(</span>algorithm <span class="op">=</span> <span class="st">"D2"</span>, p <span class="op">=</span> <span class="fl">0.0193</span>, Se <span class="op">=</span> <span class="fl">0.99</span>, Sp <span class="op">=</span> <span class="fl">0.99</span>,</span></span>
<span class="r-in"><span>        hier.config <span class="op">=</span> <span class="fu">GroupMembershipMatrix</span><span class="op">(</span>stage1 <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        print.time <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm: Non-informative two-stage hierarchical testing </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Testing configuration: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Stage1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected number of tests: 5.3605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected number of tests per individual: 0.3350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Accuracy for individuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PSe    PSp   PPPV   PNPV Individuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.9801 0.9974 0.8819 0.9996         All</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall accuracy of the algorithm:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PSe    PSp   PPPV   PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.9801 0.9974 0.8819 0.9996</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a group membership matrix for a five-stage</span></span></span>
<span class="r-in"><span><span class="co">#   hierarchical algorithm and calculate the</span></span></span>
<span class="r-in"><span><span class="co">#   operating characteristics for a two-disease assay</span></span></span>
<span class="r-in"><span><span class="va">config.mat</span> <span class="op">&lt;-</span> <span class="fu">GroupMembershipMatrix</span><span class="op">(</span>stage1 <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>                                    stage2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                    stage3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                    stage4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, times <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">10</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>             dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Infection <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, Stage <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.99</span>, <span class="fl">10</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>             dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Infection <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, Stage <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="operatingCharacteristics2.html">opChar2</a></span><span class="op">(</span>algorithm <span class="op">=</span> <span class="st">"D5"</span>, p.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.92</span>, <span class="fl">0.05</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        Se <span class="op">=</span> <span class="va">Se</span>, Sp <span class="op">=</span> <span class="va">Sp</span>, hier.config <span class="op">=</span> <span class="va">config.mat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of minutes running:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm: Non-informative five-stage hierarchical testing </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Testing configuration: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Stage1 Stage2  Stage3          Stage4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     16    8,8 4,4,4,4 2,2,2,2,2,2,2,2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected number of tests: 8.5165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected number of tests per individual: 0.5323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Disease 1 accuracy for individuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PSe    PSp   PPPV   PNPV Individuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.8253 0.9991 0.9835 0.9890         All</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Disease 2 accuracy for individuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PSe    PSp   PPPV   PNPV Individuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.8619 0.9989 0.9599 0.9957         All</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall accuracy of the algorithm:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PSe    PSp   PPPV   PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.8253 0.9991 0.9835 0.9890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.8619 0.9989 0.9599 0.9957</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brianna Hitt, Christopher Bilder, Frank Schaarschmidt, Brad Biggerstaff, Christopher McMahan, Joshua Tebbs.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

