<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Probability mass function for halving — halving • binGroup2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Probability mass function for halving — halving"><meta name="description" content="Calculate the probability mass function for the number of tests
from using the halving algorithm."><meta property="og:description" content="Calculate the probability mass function for the number of tests
from using the halving algorithm."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">binGroup2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Identification-through-group-testing.html">Identification-through-group-testing</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bdhitt/binGroup2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Probability mass function for halving</h1>
      <small class="dont-index">Source: <a href="https://github.com/bdhitt/binGroup2/blob/main/R/halving.R" class="external-link"><code>R/halving.R</code></a></small>
      <div class="d-none name"><code>halving.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate the probability mass function for the number of tests
from using the halving algorithm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">halving</span><span class="op">(</span><span class="va">p</span>, Se <span class="op">=</span> <span class="fl">1</span>, Sp <span class="op">=</span> <span class="fl">1</span>, stages <span class="op">=</span> <span class="fl">2</span>, order.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>a vector of individual risk probabilities.</p></dd>


<dt id="arg-se">Se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>sensitivity of the diagnostic test.</p></dd>


<dt id="arg-sp">Sp<a class="anchor" aria-label="anchor" href="#arg-sp"></a></dt>
<dd><p>specificity of the diagnostic test.</p></dd>


<dt id="arg-stages">stages<a class="anchor" aria-label="anchor" href="#arg-stages"></a></dt>
<dd><p>the number of stages for the halving algorithm.</p></dd>


<dt id="arg-order-p">order.p<a class="anchor" aria-label="anchor" href="#arg-order-p"></a></dt>
<dd><p>logical; if TRUE, the vector of individual risk probabilities
will be sorted.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p>
<dl><dt>pmf</dt>
<dd><p>the probability mass function for the halving algorithm.</p></dd>

<dt>et</dt>
<dd><p>the expected testing expenditure for the halving algorithm.</p></dd>

<dt>vt</dt>
<dd><p>the variance of the testing expenditure for the halving
          algorithm.</p></dd>

<dt>p</dt>
<dd><p>a vector containing the probabilities of positivity for each individual.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Halving algorithms involve successively splitting a positive
testing group into two equal-sized halves (or as close to equal as possible)
until all individuals have been identified as positive or negative.
\(S\)-stage halving begins by testing the whole group of \(I\)
individuals. Positive groups are split in half until the final stage of the
algorithm, which consists of individual testing. For example, consider an
initial group of size \(I=16\) individuals. Three-stage halving (3H)
begins by testing the whole group of 16 individuals. If this group tests
positive, the second stage involves splitting into two groups of size 8.
If either of these groups test positive, a third stage involves testing each
individual rather than halving again. Four-stage halving (4H) would continue
with halving into groups of size 4 before individual testing. Five-stage
halving (5H) would continue with halving into groups of size 2 before
individual testing. 3H requires more than 2 individuals, 4H requires more
than 4 individuals, and 5H requires more than 8 individuals.</p>
<p>This function calculates the probability mass function, expected testing
expenditure, and variance of the testing expenditure for halving algorithms
with 3 to 5 stages.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Black, M., Bilder, C., Tebbs, J. (2012).
“Group testing in heterogeneous populations by using halving algorithms.”
<em>Journal of the Royal Statistical Society. Series C: Applied Statistics</em>, <b>61</b>, 277–290.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="expectOrderBeta.html">expectOrderBeta</a></code> for generating a vector of individual risk
probabilities for informative group testing.</p>
<p>Other operating characteristic functions:
<code><a href="GroupMembershipMatrix.html">GroupMembershipMatrix</a>()</code>,
<code><a href="Sterrett.html">Sterrett</a>()</code>,
<code><a href="TOD.html">TOD</a>()</code>,
<code><a href="operatingCharacteristics1.html">operatingCharacteristics1</a>()</code>,
<code><a href="operatingCharacteristics2.html">operatingCharacteristics2</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>This function was originally written by Michael Black for Black
et al. (2012). The function was obtained from
<a href="http://chrisbilder.com/grouptesting/" class="external-link">http://chrisbilder.com/grouptesting/</a>. Minor modifications have been
made for inclusion of the function in the <code>binGroup2</code> package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Equivalent to Dorfman testing (two-stage hierarchical)</span></span></span>
<span class="r-in"><span><span class="fu">halving</span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">10</span><span class="op">)</span>, Se <span class="op">=</span> <span class="fl">1</span>, Sp <span class="op">=</span> <span class="fl">1</span>, stages <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        order.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pmf :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   num.tests prob.tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1     0.9044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        11     0.0956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> et :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.956179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> vt :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.647514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Halving over three stages; each individual has a</span></span></span>
<span class="r-in"><span><span class="co">#   different probability of being positive</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12895</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="expectOrderBeta.html">expectOrderBeta</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.05</span>, alpha <span class="op">=</span> <span class="fl">2</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">halving</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p.vec</span>, Se <span class="op">=</span> <span class="fl">0.95</span>, Sp <span class="op">=</span> <span class="fl">0.95</span>, stages <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        order.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pmf :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   num.tests prob.tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1     0.3690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         3     0.0399</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        13     0.4624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        23     0.1287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> et :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.459485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> vt :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 57.46018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.00813011 0.01281577 0.01672941 0.02032010 0.02376267 0.02715206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.03055215 0.03401377 0.03758344 0.04130894 0.04524401 0.04945382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.05402248 0.05906516 0.06474940 0.07133702 0.07927673 0.08944686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] 0.10398454 0.13105154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brianna Hitt, Christopher Bilder, Frank Schaarschmidt, Brad Biggerstaff, Christopher McMahan, Joshua Tebbs.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

